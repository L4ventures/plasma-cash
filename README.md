PoC, untested. 188 CLOC.
